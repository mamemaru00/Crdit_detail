# スプレッドシート構造定義書

## 概要
Googleスプレッドシートの年別シート構造。システムがデータを読み書きする対象。

## シート構成

```
スプレッドシート
├ 2023年シート
├ 2024年シート  
├ 2025年シート ← 現在使用中
├ 2026年シート
└ ...
```

## 年別シート構造

| 行番号 | 内容 | 備考 |
|--------|------|------|
| 1 | タイトル行 | 例："2025年" |
| 2 | 空行 | - |
| 3 | ヘッダー行 | "年月", "支払額", "外食費"... |
| 4～15 | 月別データ | 1月～12月（12行） |
| 16 | 年計（合計行） | SUM関数等 |
| 18～30 | 月別比率 | ％表示 |

## ヘッダー行（行3）の列構成

| 列 | カテゴリ名 | 列 | カテゴリ名 |
|----|-----------|-------|-----------|
| A | 年月 | J | 実家代 |
| B | 支払額 | K | 水道代 |
| C | 外食費 | L | 電気代・ガス代 |
| D | 日用品費 | M | 携帯費 |
| E | 車両代 | N | 交通費 |
| F | 家電 | O | 医療費 |
| G | 娯楽費 | P | 個人年金 |
| H | 交際・化粧費 | Q～V | その他 |
| I | 旅行費 | - | - |

## 月別データ行（行4～15）

### A列：月表示
```
行4: "1月"
行5: "2月"
...
行15: "12月"
```

### B～V列：カテゴリ別金額
- 数値型
- 初期値: 0または空白
- システムによる加算更新

## セル更新計算式

### 行番号計算
```python
row = 3 + month
# 例：8月 → 行11（3 + 8）
```

### 列番号変換
```python
column_index = ord(column) - ord('A') + 1
# 例：'C' → 3, 'N' → 14
```

### 更新ロジック
```python
# 既存値取得
current_value = sheet.cell(row, column).value or 0

# 新値計算
new_value = current_value + amount

# 更新実行
sheet.update_cell(row, column, new_value)
```

## アクセス権限

### サービスアカウント
- メールアドレス: `creditapi@creditapi-470614.iam.gserviceaccount.com`
- 権限: 編集者
- 共有設定: 必須

## 注意事項
- 年計（行16）は本システムでは更新しない
- 月別比率（行18～30）も更新対象外
- 手動での数式設定を推奨
- シート構造変更時はシステム側も要修正
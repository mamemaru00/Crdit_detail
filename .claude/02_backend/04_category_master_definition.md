# カテゴリマスタ定義書

## 概要
スプレッドシートの列番号とカテゴリ名の対応を定義するマスタテーブル。システム全体で共通利用。

## データ構造

| 列番号 | カテゴリ名 | 用途 | 備考 |
|--------|-----------|------|------|
| B | 支払額 | デフォルト・総額 | 未分類の振り分け先 |
| C | 外食費 | 飲食店、宅配等 | - |
| D | 日用品費 | スーパー、薬局等 | - |
| E | 車両代 | ガソリン、駐車場等 | - |
| F | 家電 | 電化製品等 | - |
| G | 娯楽費 | 遊び、サブスク等 | - |
| H | 交際・化粧費 | プレゼント、化粧品等 | - |
| I | 旅行費 | 宿泊、交通等 | - |
| J | 実家代 | 実家への送金等 | - |
| K | 水道代 | 水道料金 | - |
| L | 電気代・ガス代 | 光熱費 | - |
| M | 携帯費 | スマホ料金 | - |
| N | 交通費 | 電車、バス、タクシー等 | - |
| O | 医療費 | 病院、薬等 | - |
| P | 個人年金 | 年金支払い | - |
| Q～V | その他 | カスタムカテゴリ | 拡張用（6列分） |

## 定義ルール

### デフォルト列
- **B列（支払額）**: マッピング未登録の店舗はすべてB列に振り分け

### 列番号範囲
- **使用可能列**: B～V（21列）
- **予約列**: A列（年月表示用）
- **拡張可能列**: Q～V（6列）

### カテゴリ命名規則
- 最大10文字以内を推奨
- 用途が明確な名称を使用
- スプレッドシートのヘッダー行（行3）と一致

## スプレッドシート連携

### セル更新時の列指定
```python
# 列番号から列インデックスを計算
column_index = ord(column) - ord('A') + 1
# 例: 'C' → 3, 'N' → 14
```

### 行番号計算
```python
# 月データの行番号
row = 3 + month  # ヘッダー3行 + 月番号
# 例: 8月 → 行11
```

## 管理方法
- コード内で定数として定義
- 将来的にデータベース化も検討
- スプレッドシート構造変更時は要同期
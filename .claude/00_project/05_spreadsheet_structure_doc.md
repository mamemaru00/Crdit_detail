# Existing Spreadsheet Structure Documentation

## 1. シート構成

年度別にシートが分かれています。

```
├ 2023年シート
├ 2024年シート  
├ 2025年シート（現在使用中）
├ 2026年シート
└ ...
```

## 2. 各年シートのデータ構造

### 行構成
- **行1**: タイトル行（例：2025年）
- **行2**: 空行
- **行3**: ヘッダー行（カテゴリ名）
- **行4-15**: 月別データ（1月～12月）
- **行15**: 年計（合計行）
- **行18-30**: 月別比率（％表示）

### 列構成（全21列）
| 列 | カテゴリ名 | 列 | カテゴリ名 |
|----|-----------|----|----|
| A | 年月 | J | 実家代 |
| B | 支払額 | K | 水道代 |
| C | 外食費 | L | 電気代・ガス代 |
| D | 日用品費 | M | 携帯費 |
| E | 車両代 | N | 交通費 |
| F | 家電 | O | 医療費 |
| G | 娯楽費 | P | 個人年金 |
| H | 交際・化粧費 | Q～V | その他 |
| I | 旅行費 |  |  |

### データ例
```
A列（年月）: 1月、2月、...12月
B列～V列: 各カテゴリの金額（数値）
```

## 3. イオンカードCSVの構造

### ファイル情報
- **ファイル名形式**: meisai202510.csv
- **エンコーディング**: Shift_JIS
- **明細件数**: 約20-30件/月

### ヘッダー部（1-7行目）
- 今回ご請求金額
- お支払い日

### 明細部（8行目以降）
明細データは6桁数字で始まる行が対象

| 列番号 | 項目名 | 形式 | 例 |
|--------|--------|------|-----|
| 列0 | 利用日 | YYMMDD | 250728（2025年7月28日） |
| 列1 | 利用者区分 | 文字列 | 本人、家族 |
| 列2 | 利用先 | 文字列 | ユシンヤカマタテン |
| 列3 | 支払方法 | 文字列 | １回、分割等 |
| 列6 | 利用金額 | 数値 | 5780 |
| 列7 | 備考 | 文字列 | Apple Pay利用分 |

### データ例
```csv
250815,本人,ユシンヤカマタテン,１回,,,5780,,
250819,本人,ＡＭＡＺＯＮ．ＣＯ．ＪＰ,１回,,,1215,,
250824,本人,スイカ　ケイタイケツサイ,１回,,,5870,Ａｐｐｌｅ　Ｐａｙ利用分,
```

### 処理時の注意点
- 日付はYYMMDD形式をYYYY/MM/DD形式に変換
- Shift_JISからUTF-8へのエンコード変換が必要
- 明細行の識別は6桁数字（日付）で判定